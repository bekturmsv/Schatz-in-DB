<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Datenbankspiel - Login</title>
    <link rel="stylesheet" href="/assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/css/Navbar-Right-Links-icons.css">
    <link rel="stylesheet" href="/assets/css/Responsive-Full-Width-Grid-from-codedrops.css">
</head>
<body>
<nav class="navbar navbar-light navbar-expand-md py-3">
    <div class="container">
        <a class="navbar-brand d-flex align-items-center" href="/thymeleaf/">
            <span class="bs-icon-sm bs-icon-rounded bs-icon-primary me-2 bs-icon"></span>
            <span>Datenbankspiel</span>
        </a>
        <a class="btn btn-primary ms-md-2" role="button" href="/thymeleaf/user/register">Register</a>
    </div>
</nav>
<section class="position-relative py-4 py-xl-5">
    <div class="container">
        <div class="row d-flex justify-content-center">
            <div class="col-md-6 col-xl-4">
                <div class="card mb-5">
                    <div class="card-body d-flex flex-column align-items-center">
                        <div class="bs-icon-xl bs-icon-circle bs-icon-primary bs-icon my-4">
                            <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor"
                                 class="bi bi-person" viewBox="0 0 16 16">
                                <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                <path d="M14 13c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4z"/>
                            </svg>
                        </div>
                        <form id="login-form">
                            <input class="form-control mb-2" type="text" name="username" placeholder="Username" />
                            <input class="form-control mb-2" type="password" name="password" placeholder="Password" />
                            <button class="btn btn-success w-100" type="submit">Login</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<script>
    document.querySelector("#login-form").addEventListener("submit", async function (e) {
        e.preventDefault();
        const data = {
            username: document.querySelector('[name="username"]').value,
            password: document.querySelector('[name="password"]').value
        };
        const res = await fetch("/api/auth/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        });
        const token = await res.text();
        localStorage.setItem("token", token);
        window.location.href = "/thymeleaf/";
    });
</script>
<script src="/assets/bootstrap/js/bootstrap.min.js"></script>
</body>
</html>
